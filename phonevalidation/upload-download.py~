import csv
import urllib2
import json


class Validator:

	def verify(self,samplename):
		req = urllib2.Request("http://api.quickemailverification.com/v1/verify?email=%s&apikey=88c007596a01f4fe7c8a8bb5cfdec7a93e45d29227ecd5032f8f537c776e"%(samplename))
		response = urllib2.urlopen(req)
		answer = response.read()
		answer = json.loads(answer)
		row['username'] = answer['user']
		row['domain_name'] = answer['domain']
		row['email'] = answer['email']

                if(answer['result'] == 'valid'):
                        with open('valid2.csv', 'a') as fv:
                                w = csv.DictWriter(fv, row.keys())
                                w.writerow(row)
                        
                elif(answer['result'] == 'unknown'):
                        with open('risky2.csv', 'a') as fr:
                                w = csv.DictWriter(fr, row.keys())
                                w.writerow(row)

                else:
                        pass


        def fieldnames(self):
                with open('inputfile.csv', 'rb') as f:
                        reader = csv.DictReader(f)         
                        for row in reader:
				row['email'] = ''
                                true = 1
                                if(true == 1):
                                        with open('corporationwiki_input1.csv', 'wb') as fv:
                                                w = csv.DictWriter(fv, row.keys())
                                                w.writeheader()

                  		break                

        def fullname(self,row):
                name = row['name']
                return name

        def domainname(self,row):
                domain = row['domain_name']
                return domain

	def firstname(self,name,domain):
                samplename = name.lower().split()
		firstname = samplename[0]
		samplename = firstname+"@"+domain
		row['email'] = samplename
		with open('corporationwiki_input1.csv', 'a') as fv:
		        w = csv.DictWriter(fv, row.keys())
		        w.writerow(row)

val = Validator()
val.fieldnames()                     

with open('inputfile.csv', 'rb') as f:
                                   
        reader = csv.DictReader(f)
        for row in reader:
                phone_no = val.fullname(row)
                val.firstname(name, domain)

                
